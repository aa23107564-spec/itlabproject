# ç« ç¯€äºŒæ¸¬è©¦æ–‡æª”

## ğŸ“‹ æ¸¬è©¦æ¦‚è¦½

æœ¬ç« ç¯€äºŒçš„æ¸¬è©¦å¥—ä»¶åŒ…å«ä»¥ä¸‹æ¸¬è©¦æ–‡ä»¶ï¼š

### 1. Chapter2.test.js
**ä¸»è¦çµ„ä»¶æ¸¬è©¦**
- æ¸²æŸ“æ¸¬è©¦
- é–‹å ´å‹•ç•«åºåˆ— (8ç§’)
- èƒŒæ™¯åœ–ç‰‡è½‰å ´æ•ˆæœ
- çµå±€åˆ†æ”¯è™•ç† (ending-a vs ending-b-a)
- ç‹€æ…‹ç®¡ç†å’Œæ¸…ç†

### 2. VisualNovelEngine.test.js
**è¦–è¦ºå°èªªå¼•æ“æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦**
- å°è©±é¡¯ç¤ºå’Œæ‰“å­—æ©Ÿæ•ˆæœ
- éµç›¤å°èˆª (å·¦å³æ–¹å‘éµ)
- é¸æ“‡ç³»çµ±
- å‹•ç•«ç¯€é»è™•ç†
- æ…¢é€Ÿæ‰“å­—æ¨™ç±¤
- å›é€€åŠŸèƒ½
- çµå±€å®Œæˆå›èª¿

### 3. DrinkCoffeeAnimation.test.js
**å–å’–å•¡å‹•ç•«æ¸¬è©¦**
- å‹•ç•«æ™‚é–“è»¸ (5ç§’)
- åœ–ç‰‡é€æ˜åº¦è®ŠåŒ–
- CSS éæ¸¡æ•ˆæœ
- çµ„ä»¶çµæ§‹é©—è­‰
- å®šæ™‚å™¨æ¸…ç†

### 4. SlowTypingEffect.test.js
**æ…¢é€Ÿæ‰“å­—æ•ˆæœæ¸¬è©¦**
- æ­£å¸¸é€Ÿåº¦ (40ms/å­—)
- æ…¢é€Ÿæ¨™ç±¤ (150ms/å­—)
- æ¨™é»ç¬¦è™Ÿåœé “ (400ms)
- æ··åˆæ–‡æœ¬è™•ç†
- æ¨™ç±¤åµŒå¥—
- æ‰“å­—æ©Ÿè·³éåŠŸèƒ½

### 5. Chapter2Integration.test.js
**é›†æˆæ¸¬è©¦**
- å®Œæ•´ç« ç¯€æµç¨‹
- é–‹å ´å‹•ç•« â†’ è¦–è¦ºå°èªª â†’ çµå±€
- èƒŒæ™¯åœ–ç‰‡å±¤ç´šç®¡ç†
- ç‹€æ…‹è½‰æ›é©—è­‰
- çµ„ä»¶ç”Ÿå‘½é€±æœŸ

## ğŸ¯ æ¸¬è©¦é‡é»åŠŸèƒ½

### é–‹å ´å‹•ç•« (8ç§’)
```
0s â”€â”€> 2s â”€â”€> 5s â”€â”€> 8s
â”‚      â”‚      â”‚      â”‚
22.jpg drink  22.jpg å°è©±æ¡†
æ·¡å…¥   æ·¡å…¥   è¦†è“‹   é¡¯ç¤º
```

### å–å’–å•¡å‹•ç•« (5ç§’)
```
0s â”€â”€> 1s â”€â”€> 2.5s â”€â”€> 3.5s â”€â”€> 5s
â”‚      â”‚      â”‚        â”‚        â”‚
22.jpg drink  drink    22.jpg   å°è©±æ¡†
é¡¯ç¤º   æ·¡å…¥   åœç•™     æ·¡å…¥     é¡¯ç¤º
```

### æ…¢é€Ÿæ‰“å­—æ•ˆæœ
- æ™®é€šæ–‡å­—ï¼š40ms/å­—
- `<slow>` æ¨™ç±¤ï¼š150ms/å­—
- æ¨™é»ç¬¦è™Ÿï¼š400ms åœé “

## ğŸš€ é‹è¡Œæ¸¬è©¦

### é‹è¡Œæ‰€æœ‰ç« ç¯€äºŒæ¸¬è©¦
```bash
npm run test:chapter2
```

### é‹è¡Œç‰¹å®šæ¸¬è©¦
```bash
# ä¸»çµ„ä»¶æ¸¬è©¦
npm test Chapter2.test.js

# è¦–è¦ºå°èªªå¼•æ“æ¸¬è©¦
npm test VisualNovelEngine.test.js

# å‹•ç•«æ¸¬è©¦
npm test DrinkCoffeeAnimation.test.js

# æ…¢é€Ÿæ‰“å­—æ¸¬è©¦
npm test SlowTypingEffect.test.js

# é›†æˆæ¸¬è©¦
npm test Chapter2Integration.test.js
```

### é‹è¡Œæ¸¬è©¦ä¸¦ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
```bash
npm test -- --coverage --testPathPattern="Chapter2|VisualNovel|DrinkCoffee|SlowTyping"
```

## ğŸ“Š æ¸¬è©¦è¦†è“‹ç¯„åœ

| çµ„ä»¶ | æ¸¬è©¦è¦†è“‹ | åŠŸèƒ½æ¸¬è©¦ |
|-----|---------|---------|
| Chapter2 | âœ… | é–‹å ´å‹•ç•«ã€èƒŒæ™¯è½‰å ´ã€çµå±€è™•ç† |
| VisualNovelEngine | âœ… | å°è©±ç³»çµ±ã€å°èˆªã€é¸æ“‡ã€å‹•ç•« |
| DrinkCoffeeAnimation | âœ… | å‹•ç•«æ™‚é–“è»¸ã€é€æ˜åº¦è®ŠåŒ– |
| SlowTypingEffect | âœ… | æ‰“å­—é€Ÿåº¦ã€æ¨™ç±¤è™•ç† |
| é›†æˆæ¸¬è©¦ | âœ… | å®Œæ•´æµç¨‹ã€ç‹€æ…‹ç®¡ç† |

## ğŸ”§ Mock ç­–ç•¥

### çµ„ä»¶ Mock
- `LongPressBackToLogin`: ç°¡åŒ–ç‚ºæ¸¬è©¦æ¨™è­˜
- `ChatboxMe/Editor`: é¡¯ç¤ºæ–‡å­—å’Œç‹€æ…‹
- `SelectOption`: å¯é»æ“ŠæŒ‰éˆ•
- `DrinkCoffeeAnimation`: æ¸¬è©¦æ¨™è­˜

### è…³æœ¬ Mock
- `chapter2Script`: ä½¿ç”¨ç°¡åŒ–æ¸¬è©¦æ•¸æ“š
- é¿å…åŠ è¼‰å¯¦éš›è…³æœ¬æ–‡ä»¶çš„è¤‡é›œæ€§

### å®šæ™‚å™¨ Mock
- ä½¿ç”¨ `jest.useFakeTimers()`
- ç²¾ç¢ºæ§åˆ¶å‹•ç•«æ™‚é–“è»¸
- æ¸¬è©¦ç•°æ­¥ç‹€æ…‹è®ŠåŒ–

## ğŸ¨ æ¸¬è©¦å ´æ™¯

### æ­£å¸¸æµç¨‹
1. é–‹å ´å‹•ç•« (8ç§’)
2. é¡¯ç¤ºè¦–è¦ºå°èªªå¼•æ“
3. ç”¨æˆ¶äº¤äº’ (å°è©±ã€é¸æ“‡)
4. å®Œæˆçµå±€åˆ†æ”¯
5. è§¸ç™¼çµå±€æ•ˆæœ

### ç•°å¸¸æƒ…æ³
- çµ„ä»¶å¸è¼‰æ™‚çš„æ¸…ç†
- å¿«é€Ÿç‹€æ…‹åˆ‡æ›
- å®šæ™‚å™¨æ¸…ç†
- å…§å­˜æ´©æ¼æª¢æŸ¥

### é‚Šç•Œæ¸¬è©¦
- å‹•ç•«æ™‚é–“é‚Šç•Œ
- æ‰“å­—æ©Ÿé€Ÿåº¦é‚Šç•Œ
- ç‹€æ…‹è½‰æ›é‚Šç•Œ
- ç”¨æˆ¶äº¤äº’é‚Šç•Œ

## ğŸ“ æ¸¬è©¦æœ€ä½³å¯¦è¸

1. **ä½¿ç”¨ fake timers**: ç²¾ç¢ºæ§åˆ¶å‹•ç•«æ™‚é–“
2. **Mock ä¾è³´**: éš”é›¢æ¸¬è©¦ç›®æ¨™
3. **ç•°æ­¥æ¸¬è©¦**: ä½¿ç”¨ `waitFor` ç­‰å¾…ç‹€æ…‹è®ŠåŒ–
4. **æ¸…ç†æ¸¬è©¦**: ç¢ºä¿æ²’æœ‰å…§å­˜æ´©æ¼
5. **è¦†è“‹ç‡**: é”åˆ° 80%+ çš„æ¸¬è©¦è¦†è“‹ç‡

## ğŸ› å¸¸è¦‹å•é¡Œ

### å®šæ™‚å™¨å•é¡Œ
```javascript
beforeEach(() => {
  jest.useFakeTimers();
});

afterEach(() => {
  jest.runOnlyPendingTimers();
  jest.useRealTimers();
});
```

### ç•°æ­¥ç‹€æ…‹æ¸¬è©¦
```javascript
await waitFor(() => {
  expect(element).toBeInTheDocument();
});
```

### Mock çµ„ä»¶
```javascript
jest.mock('../Component', () => {
  return function MockComponent() {
    return <div data-testid="mock-component" />;
  };
});
```
